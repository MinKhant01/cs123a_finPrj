# Exploring Pairwise Local Alignment of Amino Acid Sequences through Python Development Utilizing Blocks Substitution Matrices from BioPython 1.85

## Authors
- Brioso, Ryuji
- Khant, Min Thwin

## Overview
This repository contains tools for performing local sequence alignment using the Smith-Waterman algorithm and for managing alignment output metrics. The project now supports multiple BLOSUM matrices and flexible file naming conventions, including reversible sequence pair names.

## Tools

### 1. sw.py (Smith-Waterman Alignment)
`sw.py` performs local pairwise alignment between two protein sequences provided in FASTA format. It:
- Loads different BLOSUM matrices (BLOSUM45, BLOSUM50, BLOSUM62, BLOSUM80).
- Supports both gapped and ungapped alignment.
- Calculates alignment score, percentage identity, coverage, gap metrics, and an estimated E-value.
- Outputs the dynamic programming (DP) matrix and context matrix as CSV files.
- Saves alignment metrics and benchmark results in a text file.

**Usage Examples:**
```bash
# Align using custom gap penalty (default gap penalty is 5)
python3 sw.py seqA.fasta seqB.fasta --gap_penalty 2

# Align using gapped or ungapped K and λ values for E-value (default option is gapped values)
python3 sw.py seqA.fasta seqB.fasta --ungapped

# Run alignment using the default BLOSUM62 matrix:
python3 sw.py seqA.fasta seqB.fasta

# Run alignment using a specific matrix:
python3 sw.py seqA.fasta seqB.fasta --matrix BLOSUM80

# Run alignment for all matrices:
python3 sw.py seqA.fasta seqB.fasta --matrix ALL

# Complete Command Interface
python3 sw.py (seqA.fasta|seqB.fasta) (seqB.fasta|seqA.fasta) [--matrix (BLOSUM45|BLOSUM50|BLOSUM62|BLOSUM80|ALL)] [--gap_penalty int] [--ungapped]
```
**Output Folder Structure:**  
For each BLOSUM matrix used, an output folder is created with the following structure:
`<sequence1>-<sequence2>_<MATRIX>_output`  
Inside each output directory, you can expect the following files:
- `<sequence1>-<sequence2>_<MATRIX>_contextMatrix.csv`: the context matrix used for alignment.
- `<sequence1>-<sequence2>_<MATRIX>_DPMatrix.csv`: the dynamic programming matrix calculated from alignment.
- `<sequence1>-<sequence2>_<MATRIX>_metrics.txt`: A text file containing alignment metrics (score, percentage identity, coverage, gap metrics, estimated E-value) and benchmark details.


### 2. extractor.sh (Extractor Shell Program)
`extractor.sh` extracts and displays alignment metrics from the output folders generated by `sw.py` program.
- Searches for metrics files in output directories corresponding to each BLOSUM matrix.
- Automatically handles reversible sequence pair file names (e.g., `human-denisovan` and `denisovan-human`).
- Extracts key metrics such as alignment score and estimated E-value.
- Can display results for a specific sequence pair with a particular BLOSUM matrix or for all sequence pairs and matrices available in the current directory.

**Usage Examples**
```bash
# Extract metrics across all BLOSUM matrices for a given sequence pair:
./extractor.sh seqA-seqB

# Extract metrics for a specific BLOSUM matrix for a given sequence pair :
./extractor.sh seqA-seqB (BLOSUMXX|blosumxx)

# Extract metrics across all BLOSUM matrices for all sequence pairs available in the current directory:
./extractor.sh

# Complete Command Interface
./extractor.sh [(seqA-seqB|seqB-seqA)] [(BLOSUMXX|blosumxx)]
```

## Dependencies
- **Python 3.x** – Required for running `sw.py`.
- **NumPy** – Used for efficient matrix operations.
- **Biopython** – Provides substitution matrices (BLOSUM45, BLOSUM50, BLOSUM62, BLOSUM80) and protein data.
- **Bash** – Required for running `extractor.sh`.
- **Standard Libraries** – Modules such as math, argparse, time, resource, sys, os, and csv are also used.
